---
title: Testing position and rotation
author: Kara Woo
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: github_document
---

```{r knitr-setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      message = FALSE,
                      warning = FALSE,
                      fig.path = "figs/trig/",
                      fig.align = "center",
                      fig.asp = 0.618,
                      out.width = "60%")
```

Placement of strip text is incorrect when the text is at angles other than 0,
90, 180, 270. Testing out some trigonometry to improve this.

```{r }
library("ggplot2")
library("grid")
```

```{r }
display_tg <- function(label = "pineapple", ...) {
  tg <- ggplot2:::titleGrob(label, x = NULL, y = NULL, ..., debug = TRUE)
  grid.newpage()
  grid.rect()
  grid.draw(tg)
}
```

Using [this commit](https://github.com/karawoo/ggplot2/commit/ed1bcace71323cdd088c31de87679820c5b2339a):

```{r right-angles-just-0}
sapply(c(0, 90, 180, 270), function(x) display_tg(hjust = 0, vjust = 0, angle = x))
```

```{r intermediate-angles-just-0}
sapply(c(45, 135, 225, 315), function(x) display_tg(hjust = 0, vjust = 0, angle = x))
```

```{r right-angles}
sapply(c(0, 90, 180, 270), function(x) display_tg(hjust = 0.2, vjust = 0.6, angle = x))
```

```{r intermediate-angles}
sapply(c(45, 135, 225, 315), function(x) display_tg(hjust = 0.2, vjust = 0.6, angle = x))
```

Some sample plots:

```{r actual-plots}
df <- data.frame(
  x = 1:2,
  y = 1:2,
  z = c("a", "aaaaaaabc"),
  g = c("b", "bbbbbbbcd")
)

base <- ggplot(df, aes(x, y)) + 
  geom_point() +
  facet_grid(g ~ z)

base + 
  theme(
    strip.text.x = element_text(hjust = 0, debug = TRUE),
    strip.text.y = element_text(angle = 45, hjust = 0, debug = TRUE)
  )

base + 
  theme(
    strip.text.x = element_text(angle = 315, debug = TRUE),
    axis.text.x = element_text(angle = -90)
  )
```
